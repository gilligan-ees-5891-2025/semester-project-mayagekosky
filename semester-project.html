<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Maya Gekosky">
<meta name="dcterms.date" content="2025-04-21">

<title>Geochemical Analyses of Hiko Canyon</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="semester-project_files/libs/clipboard/clipboard.min.js"></script>
<script src="semester-project_files/libs/quarto-html/quarto.js"></script>
<script src="semester-project_files/libs/quarto-html/popper.min.js"></script>
<script src="semester-project_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="semester-project_files/libs/quarto-html/anchor.min.js"></script>
<link href="semester-project_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="semester-project_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="semester-project_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="semester-project_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="semester-project_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Geochemical Analyses of Hiko Canyon</h1>
<p class="subtitle lead">EES 4891/5891: Probability and Statistics for Geosciences</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Maya Gekosky </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 21, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<p>Set up R environment by loading the necessary libraries</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># set up default plotting format for ggplot2 graphs</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In this study I will be analyzing the whole rock geochemical analyses for 13 rock samples. These rock samples are from Hiko Canyon, a small area within the Spirit Mountain batholith, southern Nevada.</p>
<p>Hiko Canyon is known for its heterogeneity and diverse magmatic interactions. It contains various degrees of both mixing and mingling of felsic and mafic magmas. I am interested in further exploring the magmatic interactions that occur here through analyzing the geochemistry of rock samples to see any relationships between units.</p>
<p>There are five main units within the system: quartz-monzonite, fine-grained granite, diorite, amphibole-rich diorite, and intermediate. We have proposed that the fine-grained granite sample is a felsic end-member and the diorites are mafic end-members with the intermediate compositions representing some mixture of the two. My data set comes from the sampled units taken from Hiko Canyon. Rock slabs were made at Vanderbilt and then they were processed and analyzed for major and trace elements by Activation Laboratories Ltd.</p>
<section id="data-set" class="level3">
<h3 class="anchored" data-anchor-id="data-set">Data set</h3>
<p>The data set we are looking at shows geochemical analyses for 13 rock samples. All of the variables measured are analytes (major elements and trace elements). There are 56 columns ( 55 are analytes, one contains labels/sample names). Out of my 13 samples there are 3 quartz monzonites, 4 fine-grained granites, 1 diorite, 1 amphibole-rich diorite, and 4 intermediate samples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readxl' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"hiko_geochem.xlsx"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `` -&gt; `...2`
• `` -&gt; `...3`
• `` -&gt; `...4`
• `` -&gt; `...5`
• `` -&gt; `...6`
• `` -&gt; `...7`
• `` -&gt; `...8`
• `` -&gt; `...9`
• `` -&gt; `...10`
• `` -&gt; `...11`
• `` -&gt; `...12`
• `` -&gt; `...13`
• `` -&gt; `...14`
• `` -&gt; `...15`
• `` -&gt; `...16`
• `` -&gt; `...17`
• `` -&gt; `...18`
• `` -&gt; `...19`
• `` -&gt; `...20`
• `` -&gt; `...21`
• `` -&gt; `...22`
• `` -&gt; `...23`
• `` -&gt; `...24`
• `` -&gt; `...25`
• `` -&gt; `...26`
• `` -&gt; `...27`
• `` -&gt; `...28`
• `` -&gt; `...29`
• `` -&gt; `...30`
• `` -&gt; `...31`
• `` -&gt; `...32`
• `` -&gt; `...33`
• `` -&gt; `...34`
• `` -&gt; `...35`
• `` -&gt; `...36`
• `` -&gt; `...37`
• `` -&gt; `...38`
• `` -&gt; `...39`
• `` -&gt; `...40`
• `` -&gt; `...41`
• `` -&gt; `...42`
• `` -&gt; `...43`
• `` -&gt; `...44`
• `` -&gt; `...45`
• `` -&gt; `...46`
• `` -&gt; `...47`
• `` -&gt; `...48`
• `` -&gt; `...49`
• `` -&gt; `...50`
• `` -&gt; `...51`
• `` -&gt; `...52`
• `` -&gt; `...53`
• `` -&gt; `...54`
• `` -&gt; `...55`
• `` -&gt; `...56`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df) <span class="co">#tells us how many rows and columns there are. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 18
Columns: 56
$ `Report Number: A24-06465` &lt;chr&gt; "Report Date: 3/7/2024", "Analyte Symbol", …
$ ...2                       &lt;chr&gt; NA, "SiO2", "%", "0.01", "FUS-ICP", "65.576…
$ ...3                       &lt;chr&gt; NA, "Al2O3", "%", "0.01", "FUS-ICP", "16.75…
$ ...4                       &lt;chr&gt; NA, "Fe2O3(T)", "%", "0.01", "FUS-ICP", "3.…
$ ...5                       &lt;chr&gt; NA, "MnO", "%", "5.0000000000000001E-3", "F…
$ ...6                       &lt;chr&gt; NA, "MgO", "%", "0.01", "FUS-ICP", "0.49056…
$ ...7                       &lt;chr&gt; NA, "CaO", "%", "0.01", "FUS-ICP", "1.60185…
$ ...8                       &lt;chr&gt; NA, "Na2O", "%", "0.01", "FUS-ICP", "3.7543…
$ ...9                       &lt;chr&gt; NA, "K2O", "%", "0.01", "FUS-ICP", "7.96924…
$ ...10                      &lt;chr&gt; NA, "TiO2", "%", "1E-3", "FUS-ICP", "0.6557…
$ ...11                      &lt;chr&gt; NA, "P2O5", "%", "0.01", "FUS-ICP", "0.1101…
$ ...12                      &lt;chr&gt; NA, "Sc", "ppm", "1", "FUS-ICP", "12", "21"…
$ ...13                      &lt;chr&gt; NA, "Be", "ppm", "1", "FUS-ICP", "1", "2", …
$ ...14                      &lt;chr&gt; NA, "V", "ppm", "5", "FUS-ICP", "23", "146"…
$ ...15                      &lt;chr&gt; NA, "Cr", "ppm", "20", "FUS-MS", "&lt; 20", "5…
$ ...16                      &lt;chr&gt; NA, "Co", "ppm", "1", "FUS-MS", "2", "21", …
$ ...17                      &lt;chr&gt; NA, "Ni", "ppm", "20", "FUS-MS", "&lt; 20", "3…
$ ...18                      &lt;chr&gt; NA, "Cu", "ppm", "10", "FUS-MS", "20", "30"…
$ ...19                      &lt;chr&gt; NA, "Zn", "ppm", "30", "FUS-MS", "50", "70"…
$ ...20                      &lt;chr&gt; NA, "Ga", "ppm", "1", "FUS-MS", "20", "19",…
$ ...21                      &lt;chr&gt; NA, "Ge", "ppm", "0.5", "FUS-MS", "1.3", "1…
$ ...22                      &lt;chr&gt; NA, "As", "ppm", "5", "FUS-MS", "&lt; 5", "&lt; 5…
$ ...23                      &lt;chr&gt; NA, "Rb", "ppm", "1", "FUS-MS", "123", "55"…
$ ...24                      &lt;chr&gt; NA, "Sr", "ppm", "2", "FUS-ICP", "162", "32…
$ ...25                      &lt;chr&gt; NA, "Y", "ppm", "0.5", "FUS-MS", "44.9", "3…
$ ...26                      &lt;chr&gt; NA, "Zr", "ppm", "1", "FUS-ICP", "720", "25…
$ ...27                      &lt;chr&gt; NA, "Nb", "ppm", "0.2", "FUS-MS", "25.7", "…
$ ...28                      &lt;chr&gt; NA, "Mo", "ppm", "2", "FUS-MS", "2", "2", "…
$ ...29                      &lt;chr&gt; NA, "Ag", "ppm", "0.5", "FUS-MS", "&lt; 0.5", …
$ ...30                      &lt;chr&gt; NA, "In", "ppm", "0.1", "FUS-MS", "0.1", "0…
$ ...31                      &lt;chr&gt; NA, "Sn", "ppm", "1", "FUS-MS", "2", "2", "…
$ ...32                      &lt;chr&gt; NA, "Sb", "ppm", "0.2", "FUS-MS", "&lt; 0.2", …
$ ...33                      &lt;chr&gt; NA, "Cs", "ppm", "0.1", "FUS-MS", "0.9", "0…
$ ...34                      &lt;chr&gt; NA, "Ba", "ppm", "2", "FUS-ICP", "642", "69…
$ ...35                      &lt;chr&gt; NA, "La", "ppm", "0.05", "FUS-MS", "190", "…
$ ...36                      &lt;chr&gt; NA, "Ce", "ppm", "0.05", "FUS-MS", "373", "…
$ ...37                      &lt;chr&gt; NA, "Pr", "ppm", "0.01", "FUS-MS", "39.7000…
$ ...38                      &lt;chr&gt; NA, "Nd", "ppm", "0.05", "FUS-MS", "133", "…
$ ...39                      &lt;chr&gt; NA, "Sm", "ppm", "0.01", "FUS-MS", "20.3999…
$ ...40                      &lt;chr&gt; NA, "Eu", "ppm", "5.0000000000000001E-3", "…
$ ...41                      &lt;chr&gt; NA, "Gd", "ppm", "0.01", "FUS-MS", "13.7", …
$ ...42                      &lt;chr&gt; NA, "Tb", "ppm", "0.01", "FUS-MS", "1.8", "…
$ ...43                      &lt;chr&gt; NA, "Dy", "ppm", "0.01", "FUS-MS", "9.30000…
$ ...44                      &lt;chr&gt; NA, "Ho", "ppm", "0.01", "FUS-MS", "1.79", …
$ ...45                      &lt;chr&gt; NA, "Er", "ppm", "0.01", "FUS-MS", "4.84", …
$ ...46                      &lt;chr&gt; NA, "Tm", "ppm", "5.0000000000000001E-3", "…
$ ...47                      &lt;chr&gt; NA, "Yb", "ppm", "0.01", "FUS-MS", "4.37", …
$ ...48                      &lt;chr&gt; NA, "Lu", "ppm", "2E-3", "FUS-MS", "0.66500…
$ ...49                      &lt;chr&gt; NA, "Hf", "ppm", "0.1", "FUS-MS", "15.6", "…
$ ...50                      &lt;chr&gt; NA, "Ta", "ppm", "0.01", "FUS-MS", "1.6", "…
$ ...51                      &lt;chr&gt; NA, "W", "ppm", "0.5", "FUS-MS", "3.9", "7.…
$ ...52                      &lt;chr&gt; NA, "Tl", "ppm", "0.05", "FUS-MS", "0.51", …
$ ...53                      &lt;chr&gt; NA, "Pb", "ppm", "5", "FUS-MS", "29", "12",…
$ ...54                      &lt;chr&gt; NA, "Bi", "ppm", "0.1", "FUS-MS", "&lt; 0.1", …
$ ...55                      &lt;chr&gt; NA, "Th", "ppm", "0.05", "FUS-MS", "26", "8…
$ ...56                      &lt;chr&gt; NA, "U", "ppm", "0.01", "FUS-MS", "1.8", "0…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(df)     <span class="co">#can observe data sheet in an expanded format.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="descriptive-statistics" class="level2">
<h2 class="anchored" data-anchor-id="descriptive-statistics">Descriptive Statistics</h2>
<p>Here I will be adding a column that will associate the rock unit for each sample.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I am adding a column to associate my samples with each of their determined rock unit. Abbreviations are as follows: qtz_mon = quartz monzonite, di = diorite, int = intermediate, di_amp = amphibole-rich diorite, and fgg = fine-grained granite. </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>units <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"n/a"</span>, <span class="st">"n/a"</span>, <span class="st">"n/a"</span>, <span class="st">"n/a"</span>, <span class="st">"n/a"</span>, <span class="st">"qtz_mon"</span>, <span class="st">"di"</span>, <span class="st">"int"</span>, <span class="st">"di_amp"</span>, <span class="st">"int"</span>, <span class="st">"fgg"</span>, <span class="st">"qtz_mon"</span>, <span class="st">"int"</span>, <span class="st">"fgg"</span>, <span class="st">"fgg"</span>, <span class="st">"fgg"</span>, <span class="st">"int"</span>, <span class="st">"qtz_mon"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#checking to see I added a column </span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 18
Columns: 57
$ `Report Number: A24-06465` &lt;chr&gt; "Report Date: 3/7/2024", "Analyte Symbol", …
$ ...2                       &lt;chr&gt; NA, "SiO2", "%", "0.01", "FUS-ICP", "65.576…
$ ...3                       &lt;chr&gt; NA, "Al2O3", "%", "0.01", "FUS-ICP", "16.75…
$ ...4                       &lt;chr&gt; NA, "Fe2O3(T)", "%", "0.01", "FUS-ICP", "3.…
$ ...5                       &lt;chr&gt; NA, "MnO", "%", "5.0000000000000001E-3", "F…
$ ...6                       &lt;chr&gt; NA, "MgO", "%", "0.01", "FUS-ICP", "0.49056…
$ ...7                       &lt;chr&gt; NA, "CaO", "%", "0.01", "FUS-ICP", "1.60185…
$ ...8                       &lt;chr&gt; NA, "Na2O", "%", "0.01", "FUS-ICP", "3.7543…
$ ...9                       &lt;chr&gt; NA, "K2O", "%", "0.01", "FUS-ICP", "7.96924…
$ ...10                      &lt;chr&gt; NA, "TiO2", "%", "1E-3", "FUS-ICP", "0.6557…
$ ...11                      &lt;chr&gt; NA, "P2O5", "%", "0.01", "FUS-ICP", "0.1101…
$ ...12                      &lt;chr&gt; NA, "Sc", "ppm", "1", "FUS-ICP", "12", "21"…
$ ...13                      &lt;chr&gt; NA, "Be", "ppm", "1", "FUS-ICP", "1", "2", …
$ ...14                      &lt;chr&gt; NA, "V", "ppm", "5", "FUS-ICP", "23", "146"…
$ ...15                      &lt;chr&gt; NA, "Cr", "ppm", "20", "FUS-MS", "&lt; 20", "5…
$ ...16                      &lt;chr&gt; NA, "Co", "ppm", "1", "FUS-MS", "2", "21", …
$ ...17                      &lt;chr&gt; NA, "Ni", "ppm", "20", "FUS-MS", "&lt; 20", "3…
$ ...18                      &lt;chr&gt; NA, "Cu", "ppm", "10", "FUS-MS", "20", "30"…
$ ...19                      &lt;chr&gt; NA, "Zn", "ppm", "30", "FUS-MS", "50", "70"…
$ ...20                      &lt;chr&gt; NA, "Ga", "ppm", "1", "FUS-MS", "20", "19",…
$ ...21                      &lt;chr&gt; NA, "Ge", "ppm", "0.5", "FUS-MS", "1.3", "1…
$ ...22                      &lt;chr&gt; NA, "As", "ppm", "5", "FUS-MS", "&lt; 5", "&lt; 5…
$ ...23                      &lt;chr&gt; NA, "Rb", "ppm", "1", "FUS-MS", "123", "55"…
$ ...24                      &lt;chr&gt; NA, "Sr", "ppm", "2", "FUS-ICP", "162", "32…
$ ...25                      &lt;chr&gt; NA, "Y", "ppm", "0.5", "FUS-MS", "44.9", "3…
$ ...26                      &lt;chr&gt; NA, "Zr", "ppm", "1", "FUS-ICP", "720", "25…
$ ...27                      &lt;chr&gt; NA, "Nb", "ppm", "0.2", "FUS-MS", "25.7", "…
$ ...28                      &lt;chr&gt; NA, "Mo", "ppm", "2", "FUS-MS", "2", "2", "…
$ ...29                      &lt;chr&gt; NA, "Ag", "ppm", "0.5", "FUS-MS", "&lt; 0.5", …
$ ...30                      &lt;chr&gt; NA, "In", "ppm", "0.1", "FUS-MS", "0.1", "0…
$ ...31                      &lt;chr&gt; NA, "Sn", "ppm", "1", "FUS-MS", "2", "2", "…
$ ...32                      &lt;chr&gt; NA, "Sb", "ppm", "0.2", "FUS-MS", "&lt; 0.2", …
$ ...33                      &lt;chr&gt; NA, "Cs", "ppm", "0.1", "FUS-MS", "0.9", "0…
$ ...34                      &lt;chr&gt; NA, "Ba", "ppm", "2", "FUS-ICP", "642", "69…
$ ...35                      &lt;chr&gt; NA, "La", "ppm", "0.05", "FUS-MS", "190", "…
$ ...36                      &lt;chr&gt; NA, "Ce", "ppm", "0.05", "FUS-MS", "373", "…
$ ...37                      &lt;chr&gt; NA, "Pr", "ppm", "0.01", "FUS-MS", "39.7000…
$ ...38                      &lt;chr&gt; NA, "Nd", "ppm", "0.05", "FUS-MS", "133", "…
$ ...39                      &lt;chr&gt; NA, "Sm", "ppm", "0.01", "FUS-MS", "20.3999…
$ ...40                      &lt;chr&gt; NA, "Eu", "ppm", "5.0000000000000001E-3", "…
$ ...41                      &lt;chr&gt; NA, "Gd", "ppm", "0.01", "FUS-MS", "13.7", …
$ ...42                      &lt;chr&gt; NA, "Tb", "ppm", "0.01", "FUS-MS", "1.8", "…
$ ...43                      &lt;chr&gt; NA, "Dy", "ppm", "0.01", "FUS-MS", "9.30000…
$ ...44                      &lt;chr&gt; NA, "Ho", "ppm", "0.01", "FUS-MS", "1.79", …
$ ...45                      &lt;chr&gt; NA, "Er", "ppm", "0.01", "FUS-MS", "4.84", …
$ ...46                      &lt;chr&gt; NA, "Tm", "ppm", "5.0000000000000001E-3", "…
$ ...47                      &lt;chr&gt; NA, "Yb", "ppm", "0.01", "FUS-MS", "4.37", …
$ ...48                      &lt;chr&gt; NA, "Lu", "ppm", "2E-3", "FUS-MS", "0.66500…
$ ...49                      &lt;chr&gt; NA, "Hf", "ppm", "0.1", "FUS-MS", "15.6", "…
$ ...50                      &lt;chr&gt; NA, "Ta", "ppm", "0.01", "FUS-MS", "1.6", "…
$ ...51                      &lt;chr&gt; NA, "W", "ppm", "0.5", "FUS-MS", "3.9", "7.…
$ ...52                      &lt;chr&gt; NA, "Tl", "ppm", "0.05", "FUS-MS", "0.51", …
$ ...53                      &lt;chr&gt; NA, "Pb", "ppm", "5", "FUS-MS", "29", "12",…
$ ...54                      &lt;chr&gt; NA, "Bi", "ppm", "0.1", "FUS-MS", "&lt; 0.1", …
$ ...55                      &lt;chr&gt; NA, "Th", "ppm", "0.05", "FUS-MS", "26", "8…
$ ...56                      &lt;chr&gt; NA, "U", "ppm", "0.01", "FUS-MS", "1.8", "0…
$ units                      &lt;chr&gt; "n/a", "n/a", "n/a", "n/a", "n/a", "qtz_mon…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#rearranging my new column to the front so it's easier to view next to my samples.</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">ncol</span>(df), <span class="dv">2</span><span class="sc">:</span>(<span class="fu">ncol</span>(df) <span class="sc">-</span> <span class="dv">1</span>))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now I will calculate the average compositions and their standard deviations for each unit’s silica composition. I will only be doing this for 3 of my units since, the diorite and amphibole-rich diorite only have one sample each.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#finding the average and standard deviation for silica in quartz monzonite</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">as.numeric</span>(df[<span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">18</span>),] [[<span class="st">"...2"</span>]]), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 68.13774</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(<span class="fu">as.numeric</span>(df<span class="sc">$</span><span class="st">`</span><span class="at">...2</span><span class="st">`</span>[<span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">18</span>)]), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.525422</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#finding the average and standard deviation for silica in fine-grained granite</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">as.numeric</span>(df[<span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">16</span>),] [[<span class="st">"...2"</span>]]), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 72.05891</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(<span class="fu">as.numeric</span>(df<span class="sc">$</span><span class="st">`</span><span class="at">...2</span><span class="st">`</span>[<span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">16</span>)]), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3995456</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#finding the average and standard deviation for silica in the intermediates</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">as.numeric</span>(df[<span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">13</span>, <span class="dv">17</span>),] [[<span class="st">"...2"</span>]]), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 66.3754</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(<span class="fu">as.numeric</span>(df<span class="sc">$</span><span class="st">`</span><span class="at">...2</span><span class="st">`</span>[<span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">13</span>, <span class="dv">17</span>)]), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.54764</code></pre>
</div>
</div>
<p>From observing the values we get from our averages and standard deviation values. We can see that the fine-grained granite samples seem to be most uniform as their standard deviation is about 0.40. Below I will make q-q plots of the three samples: quartz monzonite, fine-grained granite, and the intermediates to see how well they fit a normal distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#making a q-q plot for quartz monzonite samples</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>data_vals_qtz_mon <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(df<span class="sc">$</span><span class="st">`</span><span class="at">...2</span><span class="st">`</span>[<span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">18</span>)])  <span class="co"># use your column &amp; rows</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_vals_qtz_mon)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_vals_qtz_mon, <span class="at">col =</span> <span class="st">"cyan4"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="semester-project_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#making a q-q plot for fine-grained granite samples</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>data_vals_fgg <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(df<span class="sc">$</span><span class="st">`</span><span class="at">...2</span><span class="st">`</span>[<span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">16</span>)])</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_vals_fgg)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_vals_fgg, <span class="at">col =</span> <span class="st">"purple4"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="semester-project_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#making a q-q plot for intermediate samples</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>data_vals_int <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(df<span class="sc">$</span><span class="st">`</span><span class="at">...2</span><span class="st">`</span>[<span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">13</span>, <span class="dv">17</span>)])  <span class="co"># use your column &amp; rows</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_vals_int)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_vals_int, <span class="at">col =</span> <span class="st">"magenta4"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="semester-project_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="research-questions" class="level2">
<h2 class="anchored" data-anchor-id="research-questions">Research Questions</h2>
<p>Fine-grained granites are our proposed felsic end-members of our system. The diorites are our proposed mafic end-members of our system. I would like to observe the relationships between these units by plotting bivariate diagrams of the major oxides. This will answer a couple of questions:</p>
<p>Is there a relationship between our mafic and felsic end-members?</p>
<p>Do our intermediate compositions fit within this mixing model?</p>
</section>
<section id="hypotheses-and-tests" class="level2">
<h2 class="anchored" data-anchor-id="hypotheses-and-tests">Hypotheses and Tests</h2>
<section id="hypotheses" class="level3">
<h3 class="anchored" data-anchor-id="hypotheses">Hypotheses</h3>
<p>I hypothesize that our intermediate compositions are some kind of mixture of our two end-member compositions.</p>
</section>
<section id="methods" class="level3">
<h3 class="anchored" data-anchor-id="methods">Methods</h3>
<p>This will be tested through looking at our multivariate data and creating bivariate scatterplots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'viridis' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: viridisLite</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'viridis'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:scales':

    viridis_pal</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Aluminum oxide diagram </span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># dropping my NA values</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">SiO2 =</span> <span class="fu">as.numeric</span>(...<span class="dv">2</span>),</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Al2O3 =</span> <span class="fu">as.numeric</span>(...<span class="dv">3</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SiO2), <span class="sc">!</span><span class="fu">is.na</span>(Al2O3)) <span class="sc">|&gt;</span>   </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(units <span class="sc">!=</span> <span class="st">"n/a"</span>)                    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There were 2 warnings in `mutate()`.
The first warning was:
ℹ In argument: `SiO2 = as.numeric(...2)`.
Caused by warning:
! NAs introduced by coercion
ℹ Run `dplyr::last_dplyr_warnings()` to see the 1 remaining warning.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#creating fgg avg. in plot. </span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>fgg_avg_Al2O3 <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg"</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">SiO2 =</span> <span class="fu">mean</span>(SiO2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Al2O3 =</span> <span class="fu">mean</span>(Al2O3, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">"fgg (avg)"</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co">#combining fgg with rest of data </span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>df_combined_Al <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df, fgg_avg_Al2O3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `...2` -&gt; `...3`
• `...3` -&gt; `...4`
• `...4` -&gt; `...5`
• `...5` -&gt; `...6`
• `...6` -&gt; `...7`
• `...7` -&gt; `...8`
• `...8` -&gt; `...9`
• `...9` -&gt; `...10`
• `...10` -&gt; `...11`
• `...11` -&gt; `...12`
• `...12` -&gt; `...13`
• `...13` -&gt; `...14`
• `...14` -&gt; `...15`
• `...15` -&gt; `...16`
• `...16` -&gt; `...17`
• `...17` -&gt; `...18`
• `...18` -&gt; `...19`
• `...19` -&gt; `...20`
• `...20` -&gt; `...21`
• `...21` -&gt; `...22`
• `...22` -&gt; `...23`
• `...23` -&gt; `...24`
• `...24` -&gt; `...25`
• `...25` -&gt; `...26`
• `...26` -&gt; `...27`
• `...27` -&gt; `...28`
• `...28` -&gt; `...29`
• `...29` -&gt; `...30`
• `...30` -&gt; `...31`
• `...31` -&gt; `...32`
• `...32` -&gt; `...33`
• `...33` -&gt; `...34`
• `...34` -&gt; `...35`
• `...35` -&gt; `...36`
• `...36` -&gt; `...37`
• `...37` -&gt; `...38`
• `...38` -&gt; `...39`
• `...39` -&gt; `...40`
• `...40` -&gt; `...41`
• `...41` -&gt; `...42`
• `...42` -&gt; `...43`
• `...43` -&gt; `...44`
• `...44` -&gt; `...45`
• `...45` -&gt; `...46`
• `...46` -&gt; `...47`
• `...47` -&gt; `...48`
• `...48` -&gt; `...49`
• `...49` -&gt; `...50`
• `...50` -&gt; `...51`
• `...51` -&gt; `...52`
• `...52` -&gt; `...53`
• `...53` -&gt; `...54`
• `...54` -&gt; `...55`
• `...55` -&gt; `...56`
• `...56` -&gt; `...57`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating points so I can draw a mixing line. </span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>fgg_point <span class="ot">&lt;-</span> df_combined_Al <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg (avg)"</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>di_point     <span class="ot">&lt;-</span> df_combined_Al <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"di"</span>)     <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>di_amp_point <span class="ot">&lt;-</span> df_combined_Al <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"di_amp"</span>) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting my data for Al2O3 Harker diagram. </span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>Al2O3_Plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_combined_Al, <span class="fu">aes</span>(<span class="at">x =</span> SiO2, <span class="at">y =</span> Al2O3, <span class="at">color =</span> units)) <span class="sc">+</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_segment</span>(</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fgg_point<span class="sc">$</span>SiO2, <span class="at">y =</span> fgg_point<span class="sc">$</span>Al2O3,</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> di_point<span class="sc">$</span>SiO2, <span class="at">yend =</span> di_point<span class="sc">$</span>Al2O3</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey28"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fgg_point<span class="sc">$</span>SiO2, <span class="at">y =</span> fgg_point<span class="sc">$</span>Al2O3,</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> di_amp_point<span class="sc">$</span>SiO2, <span class="at">yend =</span> di_amp_point<span class="sc">$</span>Al2O3</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey28"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">data =</span> df_combined_Al <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">!=</span> <span class="st">"fgg (avg)"</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_smooth</span>(</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_combined_Al <span class="sc">|&gt;</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>units <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fgg"</span>, <span class="st">"fgg (avg)"</span>, <span class="st">"int"</span>, <span class="st">"qtz_mon"</span>)),</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">group =</span> units),</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="cn">FALSE</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_combined_Al <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg (avg)"</span>),</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">18</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"D"</span>) <span class="sc">+</span></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">80</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">45</span>, <span class="dv">80</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"SiO2 (wt%)"</span>,</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"Al2O3 (wt%)"</span>,</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Rock Unit"</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Harker Diagram: SiO2 vs Al2O3</span><span class="sc">\n</span><span class="st">(with fgg averaged)"</span>)</span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>Al2O3_Plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = fgg_point$SiO2, y = fgg_point$Al2O3, xend = di_point$SiO2, : All aesthetics have length 1, but the data has 14 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = fgg_point$SiO2, y = fgg_point$Al2O3, xend = di_amp_point$SiO2, : All aesthetics have length 1, but the data has 14 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="semester-project_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#iron oxide harker diagram </span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># dropping my NA values</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">SiO2 =</span> <span class="fu">as.numeric</span>(...<span class="dv">2</span>),</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Fe2O3 =</span> <span class="fu">as.numeric</span>(...<span class="dv">4</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SiO2), <span class="sc">!</span><span class="fu">is.na</span>(Fe2O3)) <span class="sc">|&gt;</span>   </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(units <span class="sc">!=</span> <span class="st">"n/a"</span>)                    </span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="co">#creating fgg avg. in plot. </span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>fgg_avg_Fe2O3 <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg"</span>) <span class="sc">|&gt;</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">SiO2 =</span> <span class="fu">mean</span>(SiO2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Fe2O3 =</span> <span class="fu">mean</span>(Fe2O3, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">"fgg (avg)"</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="co">#combining fgg with rest of data </span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>df_combined_Fe <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df, fgg_avg_Fe2O3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `...2` -&gt; `...3`
• `...3` -&gt; `...4`
• `...4` -&gt; `...5`
• `...5` -&gt; `...6`
• `...6` -&gt; `...7`
• `...7` -&gt; `...8`
• `...8` -&gt; `...9`
• `...9` -&gt; `...10`
• `...10` -&gt; `...11`
• `...11` -&gt; `...12`
• `...12` -&gt; `...13`
• `...13` -&gt; `...14`
• `...14` -&gt; `...15`
• `...15` -&gt; `...16`
• `...16` -&gt; `...17`
• `...17` -&gt; `...18`
• `...18` -&gt; `...19`
• `...19` -&gt; `...20`
• `...20` -&gt; `...21`
• `...21` -&gt; `...22`
• `...22` -&gt; `...23`
• `...23` -&gt; `...24`
• `...24` -&gt; `...25`
• `...25` -&gt; `...26`
• `...26` -&gt; `...27`
• `...27` -&gt; `...28`
• `...28` -&gt; `...29`
• `...29` -&gt; `...30`
• `...30` -&gt; `...31`
• `...31` -&gt; `...32`
• `...32` -&gt; `...33`
• `...33` -&gt; `...34`
• `...34` -&gt; `...35`
• `...35` -&gt; `...36`
• `...36` -&gt; `...37`
• `...37` -&gt; `...38`
• `...38` -&gt; `...39`
• `...39` -&gt; `...40`
• `...40` -&gt; `...41`
• `...41` -&gt; `...42`
• `...42` -&gt; `...43`
• `...43` -&gt; `...44`
• `...44` -&gt; `...45`
• `...45` -&gt; `...46`
• `...46` -&gt; `...47`
• `...47` -&gt; `...48`
• `...48` -&gt; `...49`
• `...49` -&gt; `...50`
• `...50` -&gt; `...51`
• `...51` -&gt; `...52`
• `...52` -&gt; `...53`
• `...53` -&gt; `...54`
• `...54` -&gt; `...55`
• `...55` -&gt; `...56`
• `...56` -&gt; `...57`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating points so I can draw a mixing line. </span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>fgg_point <span class="ot">&lt;-</span> df_combined_Fe <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg (avg)"</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>di_point     <span class="ot">&lt;-</span> df_combined_Fe <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"di"</span>)     <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>di_amp_point <span class="ot">&lt;-</span> df_combined_Fe <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"di_amp"</span>) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting my data for Fe2O3 Harker diagram. </span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>Fe2O3_Plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_combined_Fe, <span class="fu">aes</span>(<span class="at">x =</span> SiO2, <span class="at">y =</span> Fe2O3, <span class="at">color =</span> units)) <span class="sc">+</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_segment</span>(</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fgg_point<span class="sc">$</span>SiO2, <span class="at">y =</span> fgg_point<span class="sc">$</span>Fe2O3,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> di_point<span class="sc">$</span>SiO2, <span class="at">yend =</span> di_point<span class="sc">$</span>Fe2O3</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey28"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fgg_point<span class="sc">$</span>SiO2, <span class="at">y =</span> fgg_point<span class="sc">$</span>Fe2O3,</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> di_amp_point<span class="sc">$</span>SiO2, <span class="at">yend =</span> di_amp_point<span class="sc">$</span>Fe2O3</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey28"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df_combined_Fe <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">!=</span> <span class="st">"fgg (avg)"</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_smooth</span>(</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_combined_Fe <span class="sc">|&gt;</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>units <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fgg"</span>, <span class="st">"fgg (avg)"</span>, <span class="st">"int"</span>, <span class="st">"qtz_mon"</span>)),</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">group =</span> units),</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="cn">FALSE</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_combined_Fe <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg (avg)"</span>),</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">18</span></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"D"</span>) <span class="sc">+</span></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">80</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">45</span>, <span class="dv">80</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">12</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"SiO2 (wt%)"</span>,</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"Fe2O3 (wt%)"</span>,</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Rock Unit"</span></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Harker Diagram: SiO2 vs Fe2O3</span><span class="sc">\n</span><span class="st">(with fgg averaged)"</span>)</span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>Fe2O3_Plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = fgg_point$SiO2, y = fgg_point$Fe2O3, xend = di_point$SiO2, : All aesthetics have length 1, but the data has 14 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = fgg_point$SiO2, y = fgg_point$Fe2O3, xend = di_amp_point$SiO2, : All aesthetics have length 1, but the data has 14 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="semester-project_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Magnesium oxide harker diagram </span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># dropping my NA values</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">SiO2 =</span> <span class="fu">as.numeric</span>(...<span class="dv">2</span>),</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">MnO =</span> <span class="fu">as.numeric</span>(...<span class="dv">5</span>)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SiO2), <span class="sc">!</span><span class="fu">is.na</span>(MnO)) <span class="sc">|&gt;</span>   </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(units <span class="sc">!=</span> <span class="st">"n/a"</span>)                    </span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="co">#creating fgg avg. in plot. </span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>fgg_avg_MnO <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg"</span>) <span class="sc">|&gt;</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">SiO2 =</span> <span class="fu">mean</span>(SiO2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">MnO =</span> <span class="fu">mean</span>(MnO, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">"fgg (avg)"</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="co">#combining fgg with rest of data </span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>df_combined_Mn <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df, fgg_avg_MnO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `...2` -&gt; `...3`
• `...3` -&gt; `...4`
• `...4` -&gt; `...5`
• `...5` -&gt; `...6`
• `...6` -&gt; `...7`
• `...7` -&gt; `...8`
• `...8` -&gt; `...9`
• `...9` -&gt; `...10`
• `...10` -&gt; `...11`
• `...11` -&gt; `...12`
• `...12` -&gt; `...13`
• `...13` -&gt; `...14`
• `...14` -&gt; `...15`
• `...15` -&gt; `...16`
• `...16` -&gt; `...17`
• `...17` -&gt; `...18`
• `...18` -&gt; `...19`
• `...19` -&gt; `...20`
• `...20` -&gt; `...21`
• `...21` -&gt; `...22`
• `...22` -&gt; `...23`
• `...23` -&gt; `...24`
• `...24` -&gt; `...25`
• `...25` -&gt; `...26`
• `...26` -&gt; `...27`
• `...27` -&gt; `...28`
• `...28` -&gt; `...29`
• `...29` -&gt; `...30`
• `...30` -&gt; `...31`
• `...31` -&gt; `...32`
• `...32` -&gt; `...33`
• `...33` -&gt; `...34`
• `...34` -&gt; `...35`
• `...35` -&gt; `...36`
• `...36` -&gt; `...37`
• `...37` -&gt; `...38`
• `...38` -&gt; `...39`
• `...39` -&gt; `...40`
• `...40` -&gt; `...41`
• `...41` -&gt; `...42`
• `...42` -&gt; `...43`
• `...43` -&gt; `...44`
• `...44` -&gt; `...45`
• `...45` -&gt; `...46`
• `...46` -&gt; `...47`
• `...47` -&gt; `...48`
• `...48` -&gt; `...49`
• `...49` -&gt; `...50`
• `...50` -&gt; `...51`
• `...51` -&gt; `...52`
• `...52` -&gt; `...53`
• `...53` -&gt; `...54`
• `...54` -&gt; `...55`
• `...55` -&gt; `...56`
• `...56` -&gt; `...57`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating points so I can draw a mixing line. </span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>fgg_point <span class="ot">&lt;-</span> df_combined_Mn <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg (avg)"</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>di_point     <span class="ot">&lt;-</span> df_combined_Mn <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"di"</span>)     <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>di_amp_point <span class="ot">&lt;-</span> df_combined_Mn <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"di_amp"</span>) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting my data for MnO Harker diagram. </span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>MnO_Plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_combined_Mn, <span class="fu">aes</span>(<span class="at">x =</span> SiO2, <span class="at">y =</span> MnO, <span class="at">color =</span> units)) <span class="sc">+</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_segment</span>(</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fgg_point<span class="sc">$</span>SiO2, <span class="at">y =</span> fgg_point<span class="sc">$</span>MnO,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> di_point<span class="sc">$</span>SiO2, <span class="at">yend =</span> di_point<span class="sc">$</span>MnO</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey28"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fgg_point<span class="sc">$</span>SiO2, <span class="at">y =</span> fgg_point<span class="sc">$</span>MnO,</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> di_amp_point<span class="sc">$</span>SiO2, <span class="at">yend =</span> di_amp_point<span class="sc">$</span>MnO</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey28"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df_combined_Mn <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">!=</span> <span class="st">"fgg (avg)"</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_smooth</span>(</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_combined_Mn <span class="sc">|&gt;</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>units <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fgg"</span>, <span class="st">"fgg (avg)"</span>, <span class="st">"int"</span>, <span class="st">"qtz_mon"</span>)),</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">group =</span> units),</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="cn">FALSE</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_combined_Mn <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg (avg)"</span>),</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">18</span></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"D"</span>) <span class="sc">+</span></span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">80</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">45</span>, <span class="dv">80</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.20</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.20</span>, <span class="fl">0.04</span>)) <span class="sc">+</span></span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"SiO2 (wt%)"</span>,</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"MnO (wt%)"</span>,</span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Rock Unit"</span></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Harker Diagram: SiO2 vs MnO</span><span class="sc">\n</span><span class="st">(with fgg averaged)"</span>)</span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>MnO_Plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = fgg_point$SiO2, y = fgg_point$MnO, xend = di_point$SiO2, : All aesthetics have length 1, but the data has 14 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = fgg_point$SiO2, y = fgg_point$MnO, xend = di_amp_point$SiO2, : All aesthetics have length 1, but the data has 14 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="semester-project_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#magnesium oxide harker diagram </span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># dropping my NA values</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">SiO2 =</span> <span class="fu">as.numeric</span>(...<span class="dv">2</span>),</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">MgO =</span> <span class="fu">as.numeric</span>(...<span class="dv">6</span>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SiO2), <span class="sc">!</span><span class="fu">is.na</span>(MgO)) <span class="sc">|&gt;</span>   </span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(units <span class="sc">!=</span> <span class="st">"n/a"</span>)                    </span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="co">#creating fgg avg. in plot. </span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>fgg_avg_MgO <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg"</span>) <span class="sc">|&gt;</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">SiO2 =</span> <span class="fu">mean</span>(SiO2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">MgO =</span> <span class="fu">mean</span>(MgO, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">"fgg (avg)"</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a><span class="co">#combining fgg with rest of data </span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>df_combined_Mg <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df, fgg_avg_MgO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `...2` -&gt; `...3`
• `...3` -&gt; `...4`
• `...4` -&gt; `...5`
• `...5` -&gt; `...6`
• `...6` -&gt; `...7`
• `...7` -&gt; `...8`
• `...8` -&gt; `...9`
• `...9` -&gt; `...10`
• `...10` -&gt; `...11`
• `...11` -&gt; `...12`
• `...12` -&gt; `...13`
• `...13` -&gt; `...14`
• `...14` -&gt; `...15`
• `...15` -&gt; `...16`
• `...16` -&gt; `...17`
• `...17` -&gt; `...18`
• `...18` -&gt; `...19`
• `...19` -&gt; `...20`
• `...20` -&gt; `...21`
• `...21` -&gt; `...22`
• `...22` -&gt; `...23`
• `...23` -&gt; `...24`
• `...24` -&gt; `...25`
• `...25` -&gt; `...26`
• `...26` -&gt; `...27`
• `...27` -&gt; `...28`
• `...28` -&gt; `...29`
• `...29` -&gt; `...30`
• `...30` -&gt; `...31`
• `...31` -&gt; `...32`
• `...32` -&gt; `...33`
• `...33` -&gt; `...34`
• `...34` -&gt; `...35`
• `...35` -&gt; `...36`
• `...36` -&gt; `...37`
• `...37` -&gt; `...38`
• `...38` -&gt; `...39`
• `...39` -&gt; `...40`
• `...40` -&gt; `...41`
• `...41` -&gt; `...42`
• `...42` -&gt; `...43`
• `...43` -&gt; `...44`
• `...44` -&gt; `...45`
• `...45` -&gt; `...46`
• `...46` -&gt; `...47`
• `...47` -&gt; `...48`
• `...48` -&gt; `...49`
• `...49` -&gt; `...50`
• `...50` -&gt; `...51`
• `...51` -&gt; `...52`
• `...52` -&gt; `...53`
• `...53` -&gt; `...54`
• `...54` -&gt; `...55`
• `...55` -&gt; `...56`
• `...56` -&gt; `...57`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating points so I can draw a mixing line. </span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>fgg_point <span class="ot">&lt;-</span> df_combined_Mg <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg (avg)"</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>di_point     <span class="ot">&lt;-</span> df_combined_Mg <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"di"</span>)     <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>di_amp_point <span class="ot">&lt;-</span> df_combined_Mg <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"di_amp"</span>) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting my data for MgO Harker diagram. </span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>MgO_Plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_combined_Fe, <span class="fu">aes</span>(<span class="at">x =</span> SiO2, <span class="at">y =</span> MgO, <span class="at">color =</span> units)) <span class="sc">+</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_segment</span>(</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fgg_point<span class="sc">$</span>SiO2, <span class="at">y =</span> fgg_point<span class="sc">$</span>MgO,</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> di_point<span class="sc">$</span>SiO2, <span class="at">yend =</span> di_point<span class="sc">$</span>MgO</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey28"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fgg_point<span class="sc">$</span>SiO2, <span class="at">y =</span> fgg_point<span class="sc">$</span>MgO,</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> di_amp_point<span class="sc">$</span>SiO2, <span class="at">yend =</span> di_amp_point<span class="sc">$</span>MgO</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey28"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df_combined_Mg <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">!=</span> <span class="st">"fgg (avg)"</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_smooth</span>(</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_combined_Mg <span class="sc">|&gt;</span></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>units <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fgg"</span>, <span class="st">"fgg (avg)"</span>, <span class="st">"int"</span>, <span class="st">"qtz_mon"</span>)),</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">group =</span> units),</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="cn">FALSE</span></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_combined_Mg <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg (avg)"</span>),</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">18</span></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"D"</span>) <span class="sc">+</span></span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">80</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">45</span>, <span class="dv">80</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"SiO2 (wt%)"</span>,</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"MgO (wt%)"</span>,</span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Rock Unit"</span></span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Harker Diagram: SiO2 vs MgO</span><span class="sc">\n</span><span class="st">(with fgg averaged)"</span>)</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>MgO_Plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = fgg_point$SiO2, y = fgg_point$MgO, xend = di_point$SiO2, : All aesthetics have length 1, but the data has 14 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = fgg_point$SiO2, y = fgg_point$MgO, xend = di_amp_point$SiO2, : All aesthetics have length 1, but the data has 14 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="semester-project_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calcium oxide harker diagram </span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co"># dropping my NA values</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">SiO2 =</span> <span class="fu">as.numeric</span>(...<span class="dv">2</span>),</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">CaO =</span> <span class="fu">as.numeric</span>(...<span class="dv">7</span>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SiO2), <span class="sc">!</span><span class="fu">is.na</span>(CaO)) <span class="sc">|&gt;</span>   </span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(units <span class="sc">!=</span> <span class="st">"n/a"</span>)                    </span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="co">#creating fgg avg. in plot. </span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>fgg_avg_CaO <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg"</span>) <span class="sc">|&gt;</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">SiO2 =</span> <span class="fu">mean</span>(SiO2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">CaO =</span> <span class="fu">mean</span>(CaO, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">"fgg (avg)"</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a><span class="co">#combining fgg with rest of data </span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>df_combined_Ca <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df, fgg_avg_CaO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `...2` -&gt; `...3`
• `...3` -&gt; `...4`
• `...4` -&gt; `...5`
• `...5` -&gt; `...6`
• `...6` -&gt; `...7`
• `...7` -&gt; `...8`
• `...8` -&gt; `...9`
• `...9` -&gt; `...10`
• `...10` -&gt; `...11`
• `...11` -&gt; `...12`
• `...12` -&gt; `...13`
• `...13` -&gt; `...14`
• `...14` -&gt; `...15`
• `...15` -&gt; `...16`
• `...16` -&gt; `...17`
• `...17` -&gt; `...18`
• `...18` -&gt; `...19`
• `...19` -&gt; `...20`
• `...20` -&gt; `...21`
• `...21` -&gt; `...22`
• `...22` -&gt; `...23`
• `...23` -&gt; `...24`
• `...24` -&gt; `...25`
• `...25` -&gt; `...26`
• `...26` -&gt; `...27`
• `...27` -&gt; `...28`
• `...28` -&gt; `...29`
• `...29` -&gt; `...30`
• `...30` -&gt; `...31`
• `...31` -&gt; `...32`
• `...32` -&gt; `...33`
• `...33` -&gt; `...34`
• `...34` -&gt; `...35`
• `...35` -&gt; `...36`
• `...36` -&gt; `...37`
• `...37` -&gt; `...38`
• `...38` -&gt; `...39`
• `...39` -&gt; `...40`
• `...40` -&gt; `...41`
• `...41` -&gt; `...42`
• `...42` -&gt; `...43`
• `...43` -&gt; `...44`
• `...44` -&gt; `...45`
• `...45` -&gt; `...46`
• `...46` -&gt; `...47`
• `...47` -&gt; `...48`
• `...48` -&gt; `...49`
• `...49` -&gt; `...50`
• `...50` -&gt; `...51`
• `...51` -&gt; `...52`
• `...52` -&gt; `...53`
• `...53` -&gt; `...54`
• `...54` -&gt; `...55`
• `...55` -&gt; `...56`
• `...56` -&gt; `...57`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating points so I can draw a mixing line. </span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>fgg_point <span class="ot">&lt;-</span> df_combined_Ca <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg (avg)"</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>di_point     <span class="ot">&lt;-</span> df_combined_Ca <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"di"</span>)     <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>di_amp_point <span class="ot">&lt;-</span> df_combined_Ca <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"di_amp"</span>) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting my data for CaO Harker diagram. </span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>CaO_Plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_combined_Ca, <span class="fu">aes</span>(<span class="at">x =</span> SiO2, <span class="at">y =</span> CaO, <span class="at">color =</span> units)) <span class="sc">+</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_segment</span>(</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fgg_point<span class="sc">$</span>SiO2, <span class="at">y =</span> fgg_point<span class="sc">$</span>CaO,</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> di_point<span class="sc">$</span>SiO2, <span class="at">yend =</span> di_point<span class="sc">$</span>CaO</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey28"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fgg_point<span class="sc">$</span>SiO2, <span class="at">y =</span> fgg_point<span class="sc">$</span>CaO,</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> di_amp_point<span class="sc">$</span>SiO2, <span class="at">yend =</span> di_amp_point<span class="sc">$</span>CaO</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey28"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df_combined_Ca <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">!=</span> <span class="st">"fgg (avg)"</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_smooth</span>(</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_combined_Ca <span class="sc">|&gt;</span></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>units <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fgg"</span>, <span class="st">"fgg (avg)"</span>, <span class="st">"int"</span>, <span class="st">"qtz_mon"</span>)),</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">group =</span> units),</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="cn">FALSE</span></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_combined_Ca <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg (avg)"</span>),</span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">18</span></span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"D"</span>) <span class="sc">+</span></span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">80</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">45</span>, <span class="dv">80</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">12</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"SiO2 (wt%)"</span>,</span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"CaO (wt%)"</span>,</span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Rock Unit"</span></span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Harker Diagram: SiO2 vs CaO</span><span class="sc">\n</span><span class="st">(with fgg averaged)"</span>)</span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a>CaO_Plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = fgg_point$SiO2, y = fgg_point$CaO, xend = di_point$SiO2, : All aesthetics have length 1, but the data has 14 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = fgg_point$SiO2, y = fgg_point$CaO, xend = di_amp_point$SiO2, : All aesthetics have length 1, but the data has 14 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="semester-project_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#sodium oxide harker diagram </span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># dropping my NA values</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">SiO2 =</span> <span class="fu">as.numeric</span>(...<span class="dv">2</span>),</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Na2O =</span> <span class="fu">as.numeric</span>(...<span class="dv">8</span>)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SiO2), <span class="sc">!</span><span class="fu">is.na</span>(Na2O)) <span class="sc">|&gt;</span>   </span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(units <span class="sc">!=</span> <span class="st">"n/a"</span>)                    </span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="co">#creating fgg avg. in plot. </span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>fgg_avg_Na2O <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg"</span>) <span class="sc">|&gt;</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">SiO2 =</span> <span class="fu">mean</span>(SiO2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Na2O =</span> <span class="fu">mean</span>(Na2O, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">"fgg (avg)"</span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a><span class="co">#combining fgg with rest of data </span></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>df_combined_Na <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df, fgg_avg_Na2O)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `...2` -&gt; `...3`
• `...3` -&gt; `...4`
• `...4` -&gt; `...5`
• `...5` -&gt; `...6`
• `...6` -&gt; `...7`
• `...7` -&gt; `...8`
• `...8` -&gt; `...9`
• `...9` -&gt; `...10`
• `...10` -&gt; `...11`
• `...11` -&gt; `...12`
• `...12` -&gt; `...13`
• `...13` -&gt; `...14`
• `...14` -&gt; `...15`
• `...15` -&gt; `...16`
• `...16` -&gt; `...17`
• `...17` -&gt; `...18`
• `...18` -&gt; `...19`
• `...19` -&gt; `...20`
• `...20` -&gt; `...21`
• `...21` -&gt; `...22`
• `...22` -&gt; `...23`
• `...23` -&gt; `...24`
• `...24` -&gt; `...25`
• `...25` -&gt; `...26`
• `...26` -&gt; `...27`
• `...27` -&gt; `...28`
• `...28` -&gt; `...29`
• `...29` -&gt; `...30`
• `...30` -&gt; `...31`
• `...31` -&gt; `...32`
• `...32` -&gt; `...33`
• `...33` -&gt; `...34`
• `...34` -&gt; `...35`
• `...35` -&gt; `...36`
• `...36` -&gt; `...37`
• `...37` -&gt; `...38`
• `...38` -&gt; `...39`
• `...39` -&gt; `...40`
• `...40` -&gt; `...41`
• `...41` -&gt; `...42`
• `...42` -&gt; `...43`
• `...43` -&gt; `...44`
• `...44` -&gt; `...45`
• `...45` -&gt; `...46`
• `...46` -&gt; `...47`
• `...47` -&gt; `...48`
• `...48` -&gt; `...49`
• `...49` -&gt; `...50`
• `...50` -&gt; `...51`
• `...51` -&gt; `...52`
• `...52` -&gt; `...53`
• `...53` -&gt; `...54`
• `...54` -&gt; `...55`
• `...55` -&gt; `...56`
• `...56` -&gt; `...57`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating points so I can draw a mixing line. </span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>fgg_point <span class="ot">&lt;-</span> df_combined_Na <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg (avg)"</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>di_point     <span class="ot">&lt;-</span> df_combined_Na <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"di"</span>)     <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>di_amp_point <span class="ot">&lt;-</span> df_combined_Na <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"di_amp"</span>) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting my data for Na2O Harker diagram. </span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>Na2O_Plot <span class="ot">&lt;-</span><span class="fu">ggplot</span>(df_combined_Na, <span class="fu">aes</span>(<span class="at">x =</span> SiO2, <span class="at">y =</span> Na2O, <span class="at">color =</span> units)) <span class="sc">+</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_segment</span>(</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fgg_point<span class="sc">$</span>SiO2, <span class="at">y =</span> fgg_point<span class="sc">$</span>Na2O,</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> di_point<span class="sc">$</span>SiO2, <span class="at">yend =</span> di_point<span class="sc">$</span>Na2O</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey28"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fgg_point<span class="sc">$</span>SiO2, <span class="at">y =</span> fgg_point<span class="sc">$</span>Na2O,</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> di_amp_point<span class="sc">$</span>SiO2, <span class="at">yend =</span> di_amp_point<span class="sc">$</span>Na2O</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey28"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df_combined_Na <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">!=</span> <span class="st">"fgg (avg)"</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_smooth</span>(</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_combined_Na <span class="sc">|&gt;</span></span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>units <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fgg"</span>, <span class="st">"fgg (avg)"</span>, <span class="st">"int"</span>, <span class="st">"qtz_mon"</span>)),</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">group =</span> units),</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="cn">FALSE</span></span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_combined_Na <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg (avg)"</span>),</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">18</span></span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"D"</span>) <span class="sc">+</span></span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">80</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">45</span>, <span class="dv">80</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">7</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">7</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"SiO2 (wt%)"</span>,</span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"Na2O (wt%)"</span>,</span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Rock Unit"</span></span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Harker Diagram: SiO2 vs Na2O</span><span class="sc">\n</span><span class="st">(with fgg averaged)"</span>)</span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a>Na2O_Plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = fgg_point$SiO2, y = fgg_point$Na2O, xend = di_point$SiO2, : All aesthetics have length 1, but the data has 14 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = fgg_point$SiO2, y = fgg_point$Na2O, xend = di_amp_point$SiO2, : All aesthetics have length 1, but the data has 14 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="semester-project_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#potassium oxide harker diagram </span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co"># dropping my NA values</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">SiO2 =</span> <span class="fu">as.numeric</span>(...<span class="dv">2</span>),</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">K2O =</span> <span class="fu">as.numeric</span>(...<span class="dv">9</span>)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SiO2), <span class="sc">!</span><span class="fu">is.na</span>(K2O)) <span class="sc">|&gt;</span>   </span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(units <span class="sc">!=</span> <span class="st">"n/a"</span>)                    </span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="co">#creating fgg avg. in plot. </span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>fgg_avg_K2O <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg"</span>) <span class="sc">|&gt;</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">SiO2 =</span> <span class="fu">mean</span>(SiO2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">K2O =</span> <span class="fu">mean</span>(K2O, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">"fgg (avg)"</span></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a><span class="co">#combining fgg with rest of data </span></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>df_combined_K <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df, fgg_avg_K2O)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `...2` -&gt; `...3`
• `...3` -&gt; `...4`
• `...4` -&gt; `...5`
• `...5` -&gt; `...6`
• `...6` -&gt; `...7`
• `...7` -&gt; `...8`
• `...8` -&gt; `...9`
• `...9` -&gt; `...10`
• `...10` -&gt; `...11`
• `...11` -&gt; `...12`
• `...12` -&gt; `...13`
• `...13` -&gt; `...14`
• `...14` -&gt; `...15`
• `...15` -&gt; `...16`
• `...16` -&gt; `...17`
• `...17` -&gt; `...18`
• `...18` -&gt; `...19`
• `...19` -&gt; `...20`
• `...20` -&gt; `...21`
• `...21` -&gt; `...22`
• `...22` -&gt; `...23`
• `...23` -&gt; `...24`
• `...24` -&gt; `...25`
• `...25` -&gt; `...26`
• `...26` -&gt; `...27`
• `...27` -&gt; `...28`
• `...28` -&gt; `...29`
• `...29` -&gt; `...30`
• `...30` -&gt; `...31`
• `...31` -&gt; `...32`
• `...32` -&gt; `...33`
• `...33` -&gt; `...34`
• `...34` -&gt; `...35`
• `...35` -&gt; `...36`
• `...36` -&gt; `...37`
• `...37` -&gt; `...38`
• `...38` -&gt; `...39`
• `...39` -&gt; `...40`
• `...40` -&gt; `...41`
• `...41` -&gt; `...42`
• `...42` -&gt; `...43`
• `...43` -&gt; `...44`
• `...44` -&gt; `...45`
• `...45` -&gt; `...46`
• `...46` -&gt; `...47`
• `...47` -&gt; `...48`
• `...48` -&gt; `...49`
• `...49` -&gt; `...50`
• `...50` -&gt; `...51`
• `...51` -&gt; `...52`
• `...52` -&gt; `...53`
• `...53` -&gt; `...54`
• `...54` -&gt; `...55`
• `...55` -&gt; `...56`
• `...56` -&gt; `...57`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating points so I can draw a mixing line. </span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>fgg_point <span class="ot">&lt;-</span> df_combined_K <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg (avg)"</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>di_point     <span class="ot">&lt;-</span> df_combined_K <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"di"</span>)     <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>di_amp_point <span class="ot">&lt;-</span> df_combined_K <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"di_amp"</span>) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting my data for K2O Harker diagram. </span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>K2O_Plot <span class="ot">&lt;-</span><span class="fu">ggplot</span>(df_combined_K, <span class="fu">aes</span>(<span class="at">x =</span> SiO2, <span class="at">y =</span> K2O, <span class="at">color =</span> units)) <span class="sc">+</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_segment</span>(</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fgg_point<span class="sc">$</span>SiO2, <span class="at">y =</span> fgg_point<span class="sc">$</span>K2O,</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> di_point<span class="sc">$</span>SiO2, <span class="at">yend =</span> di_point<span class="sc">$</span>K2O</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey28"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fgg_point<span class="sc">$</span>SiO2, <span class="at">y =</span> fgg_point<span class="sc">$</span>K2O,</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> di_amp_point<span class="sc">$</span>SiO2, <span class="at">yend =</span> di_amp_point<span class="sc">$</span>K2O</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey28"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df_combined_K <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">!=</span> <span class="st">"fgg (avg)"</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_smooth</span>(</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_combined_K <span class="sc">|&gt;</span></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>units <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fgg"</span>, <span class="st">"fgg (avg)"</span>, <span class="st">"int"</span>, <span class="st">"qtz_mon"</span>)),</span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">group =</span> units),</span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="cn">FALSE</span></span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_combined_K <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg (avg)"</span>),</span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">18</span></span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"D"</span>) <span class="sc">+</span></span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">80</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">45</span>, <span class="dv">80</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">9</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"SiO2 (wt%)"</span>,</span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"K2O (wt%)"</span>,</span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Rock Unit"</span></span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Harker Diagram: SiO2 vs K2O</span><span class="sc">\n</span><span class="st">(with fgg averaged)"</span>)</span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-46"><a href="#cb72-46" aria-hidden="true" tabindex="-1"></a>K2O_Plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = fgg_point$SiO2, y = fgg_point$K2O, xend = di_point$SiO2, : All aesthetics have length 1, but the data has 14 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = fgg_point$SiO2, y = fgg_point$K2O, xend = di_amp_point$SiO2, : All aesthetics have length 1, but the data has 14 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="semester-project_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#titanium oxide harker diagram </span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="co"># dropping my NA values</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">SiO2 =</span> <span class="fu">as.numeric</span>(...<span class="dv">2</span>),</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ti2O =</span> <span class="fu">as.numeric</span>(...<span class="dv">10</span>)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SiO2), <span class="sc">!</span><span class="fu">is.na</span>(Ti2O)) <span class="sc">|&gt;</span>   </span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(units <span class="sc">!=</span> <span class="st">"n/a"</span>)                    </span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="co">#creating fgg avg. in plot. </span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>fgg_avg_Ti2O <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg"</span>) <span class="sc">|&gt;</span></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">SiO2 =</span> <span class="fu">mean</span>(SiO2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ti2O =</span> <span class="fu">mean</span>(Ti2O, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">"fgg (avg)"</span></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a><span class="co">#combining fgg with rest of data </span></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>df_combined_Ti <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df, fgg_avg_Ti2O)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `...2` -&gt; `...3`
• `...3` -&gt; `...4`
• `...4` -&gt; `...5`
• `...5` -&gt; `...6`
• `...6` -&gt; `...7`
• `...7` -&gt; `...8`
• `...8` -&gt; `...9`
• `...9` -&gt; `...10`
• `...10` -&gt; `...11`
• `...11` -&gt; `...12`
• `...12` -&gt; `...13`
• `...13` -&gt; `...14`
• `...14` -&gt; `...15`
• `...15` -&gt; `...16`
• `...16` -&gt; `...17`
• `...17` -&gt; `...18`
• `...18` -&gt; `...19`
• `...19` -&gt; `...20`
• `...20` -&gt; `...21`
• `...21` -&gt; `...22`
• `...22` -&gt; `...23`
• `...23` -&gt; `...24`
• `...24` -&gt; `...25`
• `...25` -&gt; `...26`
• `...26` -&gt; `...27`
• `...27` -&gt; `...28`
• `...28` -&gt; `...29`
• `...29` -&gt; `...30`
• `...30` -&gt; `...31`
• `...31` -&gt; `...32`
• `...32` -&gt; `...33`
• `...33` -&gt; `...34`
• `...34` -&gt; `...35`
• `...35` -&gt; `...36`
• `...36` -&gt; `...37`
• `...37` -&gt; `...38`
• `...38` -&gt; `...39`
• `...39` -&gt; `...40`
• `...40` -&gt; `...41`
• `...41` -&gt; `...42`
• `...42` -&gt; `...43`
• `...43` -&gt; `...44`
• `...44` -&gt; `...45`
• `...45` -&gt; `...46`
• `...46` -&gt; `...47`
• `...47` -&gt; `...48`
• `...48` -&gt; `...49`
• `...49` -&gt; `...50`
• `...50` -&gt; `...51`
• `...51` -&gt; `...52`
• `...52` -&gt; `...53`
• `...53` -&gt; `...54`
• `...54` -&gt; `...55`
• `...55` -&gt; `...56`
• `...56` -&gt; `...57`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating points so I can draw a mixing line. </span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>fgg_point <span class="ot">&lt;-</span> df_combined_Ti <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg (avg)"</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>di_point     <span class="ot">&lt;-</span> df_combined_Ti <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"di"</span>)     <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>di_amp_point <span class="ot">&lt;-</span> df_combined_Ti <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"di_amp"</span>) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting my data for Ti2O Harker diagram. </span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>TiO2_Plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_combined_Ti, <span class="fu">aes</span>(<span class="at">x =</span> SiO2, <span class="at">y =</span> Ti2O, <span class="at">color =</span> units)) <span class="sc">+</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_segment</span>(</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fgg_point<span class="sc">$</span>SiO2, <span class="at">y =</span> fgg_point<span class="sc">$</span>Ti2O,</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> di_point<span class="sc">$</span>SiO2, <span class="at">yend =</span> di_point<span class="sc">$</span>Ti2O</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey28"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fgg_point<span class="sc">$</span>SiO2, <span class="at">y =</span> fgg_point<span class="sc">$</span>Ti2O,</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> di_amp_point<span class="sc">$</span>SiO2, <span class="at">yend =</span> di_amp_point<span class="sc">$</span>Ti2O</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey28"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df_combined_Ti <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">!=</span> <span class="st">"fgg (avg)"</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_smooth</span>(</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_combined_Ti <span class="sc">|&gt;</span></span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>units <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fgg"</span>, <span class="st">"fgg (avg)"</span>, <span class="st">"int"</span>, <span class="st">"qtz_mon"</span>)),</span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">group =</span> units),</span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="cn">FALSE</span></span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_combined_Ti <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg (avg)"</span>),</span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">18</span></span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"D"</span>) <span class="sc">+</span></span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">80</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">45</span>, <span class="dv">80</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.4</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">1.4</span>, <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"SiO2 (wt%)"</span>,</span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"Ti2O (wt%)"</span>,</span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Rock Unit"</span></span>
<span id="cb78-42"><a href="#cb78-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb78-43"><a href="#cb78-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb78-44"><a href="#cb78-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Harker Diagram: SiO2 vs Ti2O</span><span class="sc">\n</span><span class="st">(with fgg averaged)"</span>)</span>
<span id="cb78-45"><a href="#cb78-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-46"><a href="#cb78-46" aria-hidden="true" tabindex="-1"></a>TiO2_Plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = fgg_point$SiO2, y = fgg_point$Ti2O, xend = di_point$SiO2, : All aesthetics have length 1, but the data has 14 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = fgg_point$SiO2, y = fgg_point$Ti2O, xend = di_amp_point$SiO2, : All aesthetics have length 1, but the data has 14 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="semester-project_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#phosphorous pentoxide harker diagram </span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co"># dropping my NA values</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">SiO2 =</span> <span class="fu">as.numeric</span>(...<span class="dv">2</span>),</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">P2O5 =</span> <span class="fu">as.numeric</span>(...<span class="dv">11</span>)</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SiO2), <span class="sc">!</span><span class="fu">is.na</span>(P2O5)) <span class="sc">|&gt;</span>   </span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(units <span class="sc">!=</span> <span class="st">"n/a"</span>)                    </span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a><span class="co">#creating fgg avg. in plot. </span></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>fgg_avg_P2O5 <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg"</span>) <span class="sc">|&gt;</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">SiO2 =</span> <span class="fu">mean</span>(SiO2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">P2O5 =</span> <span class="fu">mean</span>(P2O5, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">"fgg (avg)"</span></span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a><span class="co">#combining fgg with rest of data </span></span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>df_combined_P <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df, fgg_avg_P2O5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `...2` -&gt; `...3`
• `...3` -&gt; `...4`
• `...4` -&gt; `...5`
• `...5` -&gt; `...6`
• `...6` -&gt; `...7`
• `...7` -&gt; `...8`
• `...8` -&gt; `...9`
• `...9` -&gt; `...10`
• `...10` -&gt; `...11`
• `...11` -&gt; `...12`
• `...12` -&gt; `...13`
• `...13` -&gt; `...14`
• `...14` -&gt; `...15`
• `...15` -&gt; `...16`
• `...16` -&gt; `...17`
• `...17` -&gt; `...18`
• `...18` -&gt; `...19`
• `...19` -&gt; `...20`
• `...20` -&gt; `...21`
• `...21` -&gt; `...22`
• `...22` -&gt; `...23`
• `...23` -&gt; `...24`
• `...24` -&gt; `...25`
• `...25` -&gt; `...26`
• `...26` -&gt; `...27`
• `...27` -&gt; `...28`
• `...28` -&gt; `...29`
• `...29` -&gt; `...30`
• `...30` -&gt; `...31`
• `...31` -&gt; `...32`
• `...32` -&gt; `...33`
• `...33` -&gt; `...34`
• `...34` -&gt; `...35`
• `...35` -&gt; `...36`
• `...36` -&gt; `...37`
• `...37` -&gt; `...38`
• `...38` -&gt; `...39`
• `...39` -&gt; `...40`
• `...40` -&gt; `...41`
• `...41` -&gt; `...42`
• `...42` -&gt; `...43`
• `...43` -&gt; `...44`
• `...44` -&gt; `...45`
• `...45` -&gt; `...46`
• `...46` -&gt; `...47`
• `...47` -&gt; `...48`
• `...48` -&gt; `...49`
• `...49` -&gt; `...50`
• `...50` -&gt; `...51`
• `...51` -&gt; `...52`
• `...52` -&gt; `...53`
• `...53` -&gt; `...54`
• `...54` -&gt; `...55`
• `...55` -&gt; `...56`
• `...56` -&gt; `...57`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating points so I can draw a mixing line. </span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>fgg_point <span class="ot">&lt;-</span> df_combined_P <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg (avg)"</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>di_point     <span class="ot">&lt;-</span> df_combined_P <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"di"</span>)     <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>di_amp_point <span class="ot">&lt;-</span> df_combined_P <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"di_amp"</span>) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting my data for P2O5 Harker diagram. </span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>P2O5_Plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_combined_P, <span class="fu">aes</span>(<span class="at">x =</span> SiO2, <span class="at">y =</span> P2O5, <span class="at">color =</span> units)) <span class="sc">+</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_segment</span>(</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fgg_point<span class="sc">$</span>SiO2, <span class="at">y =</span> fgg_point<span class="sc">$</span>P2O5,</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> di_point<span class="sc">$</span>SiO2, <span class="at">yend =</span> di_point<span class="sc">$</span>P2O5</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey28"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fgg_point<span class="sc">$</span>SiO2, <span class="at">y =</span> fgg_point<span class="sc">$</span>P2O5,</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> di_amp_point<span class="sc">$</span>SiO2, <span class="at">yend =</span> di_amp_point<span class="sc">$</span>P2O5</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey28"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df_combined_P <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">!=</span> <span class="st">"fgg (avg)"</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_smooth</span>(</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_combined_P <span class="sc">|&gt;</span></span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>units <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fgg"</span>, <span class="st">"fgg (avg)"</span>, <span class="st">"int"</span>, <span class="st">"qtz_mon"</span>)),</span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">group =</span> units),</span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="cn">FALSE</span></span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_combined_P <span class="sc">|&gt;</span> <span class="fu">filter</span>(units <span class="sc">==</span> <span class="st">"fgg (avg)"</span>),</span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">18</span></span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"D"</span>) <span class="sc">+</span></span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">80</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">45</span>, <span class="dv">80</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb84-37"><a href="#cb84-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.4</span>, <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb84-38"><a href="#cb84-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb84-39"><a href="#cb84-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"SiO2 (wt%)"</span>,</span>
<span id="cb84-40"><a href="#cb84-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"P2O5 (wt%)"</span>,</span>
<span id="cb84-41"><a href="#cb84-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Rock Unit"</span></span>
<span id="cb84-42"><a href="#cb84-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb84-43"><a href="#cb84-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb84-44"><a href="#cb84-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Harker Diagram: SiO2 vs P2O5</span><span class="sc">\n</span><span class="st">(with fgg averaged)"</span>)</span>
<span id="cb84-45"><a href="#cb84-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-46"><a href="#cb84-46" aria-hidden="true" tabindex="-1"></a>P2O5_Plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = fgg_point$SiO2, y = fgg_point$P2O5, xend = di_point$SiO2, : All aesthetics have length 1, but the data has 14 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = fgg_point$SiO2, y = fgg_point$P2O5, xend = di_amp_point$SiO2, : All aesthetics have length 1, but the data has 14 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="semester-project_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="results-and-discussion" class="level3">
<h3 class="anchored" data-anchor-id="results-and-discussion">Results and Discussion</h3>
<p>My results are as expected with intermediate compositions somewhat falling in line with the linear trends made from my proposed end-member samples. In general, intermediate samples at least fall in between the proposed end-members in silica content. The graphs that fit the best when thinking about mixing are my Fe2O3 plot and P2O5 plot. The MgO plot is interesting because although none of the intermediate samples fall exactly on a mixing line, their slopes follow the same slope as the diorite mixing line. The TiO2 plot also shows intermediates existing in between both proposed mafic end-members, although not landing on one in particular. Overall, intermediates fit the diorite to fine-grained granite model better than the amphibole-rich diorite to fine-grained granite model.</p>
</section>
</section>
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusions</h2>
<p>I learned that my Harker diagrams do not support mixing as much as I previously thought. When I first created bivariate diagrams for my samples, I made graphs within excel. My samples included all of the Spirit Mountain batholith samples, which increased the x-axis and y-axis ranges for every Harker diagram. I also created my linear trends between proposed end-members through drawing lines by hand in PowerPoint since I couldn’t figure out how to create additional lines within excel. With this information in mind, creating exact lines within R and limiting my samples to only Hiko Canyon emphasizes how poorly my data fits into these linear trends, than my first version of graphs.</p>
<p>I believe the Harker diagrams still support that mixing could occur as linear trends do support mixing, but it emphasizes the diversity and chaos of the magmatic system itself. For my next steps, I wish to figure out how to make the graphs more visually aesthetic so they are easier to observe. I would also like to figure out how to create a figure that has all of my Harkers in one place through R. I attempted to do that at the end of this project, but I couldn’t quite get the font, legends, and point sizes correct for all of my graphs to still look how they did originally. Moving forward, there is room to do more fractionation modeling as well.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>